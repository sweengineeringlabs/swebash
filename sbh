#!/usr/bin/env bash
# sbh â€” swebash quickstart entrypoint
set -euo pipefail

REPO_ROOT="$(cd "$(dirname "$0")" && pwd)"

usage() {
  echo "Usage: ./sbh <command> [options]"
  echo ""
  echo "Commands:"
  echo "  setup          One-time environment setup"
  echo "  build          Build engine (WASM) and host"
  echo "    --debug        Build in debug mode (default: release)"
  echo "  run            Build if needed and launch swebash"
  echo "    --release      Run release build"
  echo "    --debug        Run debug build (default)"
  echo "  test [suite]   Build and run tests"
  echo "    engine|host|readline|ai|scripts|all (default: all)"
  echo "  gen-aws-docs   Generate AWS reference docs from live CLI help"
}

CMD="${1:-}"
[ -n "$CMD" ] && shift

case "$CMD" in
  setup)         exec "$REPO_ROOT/bin/setup.sh"         "$@" ;;
  build)         exec "$REPO_ROOT/bin/build.sh"         "$@" ;;
  run)           exec "$REPO_ROOT/bin/run.sh"           "$@" ;;
  test)          exec "$REPO_ROOT/bin/test.sh"          "$@" ;;
  gen-aws-docs)  exec "$REPO_ROOT/bin/gen-aws-docs.sh"  "$@" ;;
  -h|--help|help|"") usage ;;
  *)
    usage
    exit 1
    ;;
esac
